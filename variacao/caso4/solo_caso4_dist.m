% faixa de passagem = 1.5 m
% norma campo elétrico ao nível do solo = 8.33 kV/m
% APROXIMA 1 e 2 m em x da configuração original

clear all; close all; clc

e_0 = 8.851*(10^(-12));
%faixa de passagem
xf = linspace(-25,25,100);
yf = 1.5;

%% APROX 1 m

n1 = 12;
r1 = 15.980*(10^-3);

x1 = [-6.975 -6.025 -6.025 -6.975 -0.475 0.475 0.475 -0.475 6.025 6.975 6.975 6.025];
y1 = [18.45 18.45 17.5 17.5 25.95 25.95 25 25 18.45 18.45 17.5 17.5];
yi1 = -y1;

%% APROX 2 m

n4 = 12;
r4 = 15.980*(10^-3);

x4 = [-5.975 -5.025 -5.025 -5.975 -0.475 0.475 0.475 -0.475 5.025 5.975 5.975 5.025];
y4 = [18.45 18.45 17.5 17.5 25.95 25.95 25 25 18.45 18.45 17.5 17.5];
yi4 = -y4;


%%

P1 = zeros(n1,n1);
for i = 1:n1
     for j = 1:n1
        if(i==j)
           P1(i,j) = (1/(2*pi*e_0))*log((4*y1(i))/(2*r1));
        else
           P1(i,j) = (1/(2*pi*e_0))*log(sqrt((x1(j)-x1(i))^2+(yi1(j)-y1(i))^2)/(sqrt((x1(j)-x1(i))^2+(y1(j)-y1(i))^2)));
        end
     end
end

%%

V1 = 500*10^3;

V1_ra = V1/sqrt(3);
V1_ia = 0;

V1_rb = V1*(cos(2*pi/3))/sqrt(3);
V1_ib = 1i*V1*(sin(2*pi/3))/sqrt(3);

V1_rc = V1*(cos(-2*pi/3))/sqrt(3);
V1_ic = 1i*V1*(sin(-2*pi/3))/sqrt(3);

Vf1 = [ V1_ra+V1_ia ; V1_ra+V1_ia ; V1_ra+V1_ia ; V1_ra+V1_ia ; V1_rb+V1_ib ; V1_rb+V1_ib ; V1_rb+V1_ib ; V1_rb+V1_ib ; V1_rc+V1_ic ; V1_rc+V1_ic ; V1_rc+V1_ic ; V1_rc+V1_ic ];


%%

rho1 = P1\Vf1;

%cabo 1 fase a
rho1_r1 = real(rho1(1)); 
rho1_i1 = imag(rho1(1));

%cabo 2 fase a
rho1_r2 = real(rho1(2));
rho1_i2 = imag(rho1(2));

%cabo 3 fase a
rho1_r3 = real(rho1(3));
rho1_i3 = imag(rho1(3));

%cabo 1 fase a
rho1_r4 = real(rho1(4));
rho1_i4 = imag(rho1(4));

%cabo 5 fase b
rho1_r5 = real(rho1(5));
rho1_i5 = imag(rho1(5));

%cabo 6 fase b
rho1_r6 = real(rho1(6));
rho1_i6 = imag(rho1(6));

%cabo 7 fase b
rho1_r7 = real(rho1(7));
rho1_i7 = imag(rho1(7));

%cabo 8 fase b
rho1_r8 = real(rho1(8));
rho1_i8 = imag(rho1(8));

%cabo 9 fase c
rho1_r9 = real(rho1(9));
rho1_i9 = imag(rho1(9));

%cabo 10 fase c
rho1_r10 = real(rho1(10));
rho1_i10 = imag(rho1(10));

%cabo 11 fase c
rho1_r11 = real(rho1(11));
rho1_i11 = imag(rho1(11));

%cabo 12 fase c
rho1_r12 = real(rho1(12));
rho1_i12 = imag(rho1(12));

%%

E1_xr1 = (rho1_r1/(2*pi*e_0)).*((xf - x1(1))./(((xf - x1(1)).^2) + (yf - y1(1)).^2) - (xf - x1(1))./(((xf - x1(1)).^2) + (yf + y1(1)).^2));
E1_xr2 = (rho1_r2/(2*pi*e_0)).*((xf - x1(2))./(((xf - x1(2)).^2) + (yf - y1(2)).^2) - (xf - x1(2))./(((xf - x1(2)).^2) + (yf + y1(2)).^2));
E1_xr3 = (rho1_r3/(2*pi*e_0)).*((xf - x1(3))./(((xf - x1(3)).^2) + (yf - y1(3)).^2) - (xf - x1(3))./(((xf - x1(3)).^2) + (yf + y1(3)).^2));
E1_xr4 = (rho1_r4/(2*pi*e_0)).*((xf - x1(4))./(((xf - x1(4)).^2) + (yf - y1(4)).^2) - (xf - x1(4))./(((xf - x1(4)).^2) + (yf + y1(4)).^2));

E1_xr5 = (rho1_r5/(2*pi*e_0)).*((xf - x1(5))./(((xf - x1(5)).^2) + (yf - y1(5)).^2) - (xf - x1(5))./(((xf - x1(5)).^2) + (yf + y1(5)).^2));
E1_xr6 = (rho1_r6/(2*pi*e_0)).*((xf - x1(6))./(((xf - x1(6)).^2) + (yf - y1(6)).^2) - (xf - x1(6))./(((xf - x1(6)).^2) + (yf + y1(6)).^2));
E1_xr7 = (rho1_r7/(2*pi*e_0)).*((xf - x1(7))./(((xf - x1(7)).^2) + (yf - y1(7)).^2) - (xf - x1(7))./(((xf - x1(7)).^2) + (yf + y1(7)).^2));
E1_xr8 = (rho1_r8/(2*pi*e_0)).*((xf - x1(8))./(((xf - x1(8)).^2) + (yf - y1(8)).^2) - (xf - x1(8))./(((xf - x1(8)).^2) + (yf + y1(8)).^2));

E1_xr9 = (rho1_r9/(2*pi*e_0)).*((xf - x1(9))./(((xf - x1(9)).^2) + (yf - y1(9)).^2) - (xf - x1(9))./(((xf - x1(9)).^2) + (yf + y1(9)).^2));
E1_xr10 = (rho1_r10/(2*pi*e_0)).*((xf - x1(10))./(((xf - x1(10)).^2) + (yf - y1(10)).^2) - (xf - x1(10))./(((xf - x1(10)).^2) + (yf + y1(10)).^2));
E1_xr11 = (rho1_r11/(2*pi*e_0)).*((xf - x1(11))./(((xf - x1(11)).^2) + (yf - y1(11)).^2) - (xf - x1(11))./(((xf - x1(11)).^2) + (yf + y1(11)).^2));
E1_xr12 = (rho1_r12/(2*pi*e_0)).*((xf - x1(12))./(((xf - x1(12)).^2) + (yf - y1(12)).^2) - (xf - x1(12))./(((xf - x1(12)).^2) + (yf + y1(12)).^2));

%%

E1_xi1 = (rho1_i1/(2*pi*e_0)).*((xf - x1(1))./(((xf - x1(1)).^2) + (yf - y1(1)).^2) - (xf - x1(1))./(((xf - x1(1)).^2) + (yf + y1(1)).^2));
E1_xi2 = (rho1_i2/(2*pi*e_0)).*((xf - x1(2))./(((xf - x1(2)).^2) + (yf - y1(2)).^2) - (xf - x1(2))./(((xf - x1(2)).^2) + (yf + y1(2)).^2));
E1_xi3 = (rho1_i3/(2*pi*e_0)).*((xf - x1(3))./(((xf - x1(3)).^2) + (yf - y1(3)).^2) - (xf - x1(3))./(((xf - x1(3)).^2) + (yf + y1(3)).^2));
E1_xi4 = (rho1_i4/(2*pi*e_0)).*((xf - x1(4))./(((xf - x1(4)).^2) + (yf - y1(4)).^2) - (xf - x1(4))./(((xf - x1(4)).^2) + (yf + y1(4)).^2));

E1_xi5 = (rho1_i5/(2*pi*e_0)).*((xf - x1(5))./(((xf - x1(5)).^2) + (yf - y1(5)).^2) - (xf - x1(5))./(((xf - x1(5)).^2) + (yf + y1(5)).^2));
E1_xi6 = (rho1_i6/(2*pi*e_0)).*((xf - x1(6))./(((xf - x1(6)).^2) + (yf - y1(6)).^2) - (xf - x1(6))./(((xf - x1(6)).^2) + (yf + y1(6)).^2));
E1_xi7 = (rho1_i7/(2*pi*e_0)).*((xf - x1(7))./(((xf - x1(7)).^2) + (yf - y1(7)).^2) - (xf - x1(7))./(((xf - x1(7)).^2) + (yf + y1(7)).^2));
E1_xi8 = (rho1_i8/(2*pi*e_0)).*((xf - x1(8))./(((xf - x1(8)).^2) + (yf - y1(8)).^2) - (xf - x1(8))./(((xf - x1(8)).^2) + (yf + y1(8)).^2));

E1_xi9 = (rho1_i9/(2*pi*e_0)).*((xf - x1(7))./(((xf - x1(9)).^2) + (yf - y1(9)).^2) - (xf - x1(9))./(((xf - x1(9)).^2) + (yf + y1(9)).^2));
E1_xi10 = (rho1_i10/(2*pi*e_0)).*((xf - x1(10))./(((xf - x1(10)).^2) + (yf - y1(10)).^2) - (xf - x1(10))./(((xf - x1(10)).^2) + (yf + y1(10)).^2));
E1_xi11 = (rho1_i11/(2*pi*e_0)).*((xf - x1(11))./(((xf - x1(11)).^2) + (yf - y1(11)).^2) - (xf - x1(11))./(((xf - x1(11)).^2) + (yf + y1(11)).^2));
E1_xi12 = (rho1_i12/(2*pi*e_0)).*((xf - x1(12))./(((xf - x1(12)).^2) + (yf - y1(12)).^2) - (xf - x1(12))./(((xf - x1(12)).^2) + (yf + y1(12)).^2));

%%

E1_yr1 = (rho1_r1/(2*pi*e_0)).*((yf - y1(1))./(((xf - x1(1)).^2) + (yf - y1(1)).^2) - (yf + y1(1))./(((xf - x1(1)).^2) + (yf + y1(1)).^2));
E1_yr2 = (rho1_r2/(2*pi*e_0)).*((yf - y1(2))./(((xf - x1(2)).^2) + (yf - y1(2)).^2) - (yf + y1(2))./(((xf - x1(2)).^2) + (yf + y1(2)).^2));
E1_yr3 = (rho1_r3/(2*pi*e_0)).*((yf - y1(3))./(((xf - x1(3)).^2) + (yf - y1(3)).^2) - (yf + y1(3))./(((xf - x1(3)).^2) + (yf + y1(3)).^2));
E1_yr4 = (rho1_r4/(2*pi*e_0)).*((yf - y1(4))./(((xf - x1(4)).^2) + (yf - y1(4)).^2) - (yf + y1(4))./(((xf - x1(4)).^2) + (yf + y1(4)).^2));

E1_yr5 = (rho1_r5/(2*pi*e_0)).*((yf - y1(5))./(((xf - x1(5)).^2) + (yf - y1(5)).^2) - (yf + y1(5))./(((xf - x1(5)).^2) + (yf + y1(5)).^2));
E1_yr6 = (rho1_r6/(2*pi*e_0)).*((yf - y1(6))./(((xf - x1(6)).^2) + (yf - y1(6)).^2) - (yf + y1(6))./(((xf - x1(6)).^2) + (yf + y1(6)).^2));
E1_yr7 = (rho1_r7/(2*pi*e_0)).*((yf - y1(7))./(((xf - x1(7)).^2) + (yf - y1(7)).^2) - (yf + y1(7))./(((xf - x1(7)).^2) + (yf + y1(7)).^2));
E1_yr8 = (rho1_r8/(2*pi*e_0)).*((yf - y1(8))./(((xf - x1(8)).^2) + (yf - y1(8)).^2) - (yf + y1(8))./(((xf - x1(8)).^2) + (yf + y1(8)).^2));

E1_yr9 = (rho1_r9/(2*pi*e_0)).*((yf - y1(9))./(((xf - x1(9)).^2) + (yf - y1(9)).^2) - (yf + y1(9))./(((xf - x1(9)).^2) + (yf + y1(9)).^2));
E1_yr10 = (rho1_r10/(2*pi*e_0)).*((yf - y1(10))./(((xf - x1(10)).^2) + (yf - y1(10)).^2) - (yf + y1(10))./(((xf - x1(10)).^2) + (yf + y1(10)).^2));
E1_yr11 = (rho1_r11/(2*pi*e_0)).*((yf - y1(11))./(((xf - x1(11)).^2) + (yf - y1(11)).^2) - (yf + y1(11))./(((xf - x1(11)).^2) + (yf + y1(11)).^2));
E1_yr12 = (rho1_r12/(2*pi*e_0)).*((yf - y1(12))./(((xf - x1(12)).^2) + (yf - y1(12)).^2) - (yf + y1(12))./(((xf - x1(12)).^2) + (yf + y1(12)).^2));

%%

E1_yi1 = (rho1_i1/(2*pi*e_0)).*((yf - y1(1))./(((xf - x1(1)).^2) + (yf - y1(1)).^2) - (yf + y1(1))./(((xf - x1(1)).^2) + (yf + y1(1)).^2));
E1_yi2 = (rho1_i2/(2*pi*e_0)).*((yf - y1(2))./(((xf - x1(2)).^2) + (yf - y1(2)).^2) - (yf + y1(2))./(((xf - x1(2)).^2) + (yf + y1(2)).^2));
E1_yi3 = (rho1_i3/(2*pi*e_0)).*((yf - y1(3))./(((xf - x1(3)).^2) + (yf - y1(3)).^2) - (yf + y1(3))./(((xf - x1(3)).^2) + (yf + y1(3)).^2));
E1_yi4 = (rho1_i4/(2*pi*e_0)).*((yf - y1(4))./(((xf - x1(4)).^2) + (yf - y1(4)).^2) - (yf + y1(4))./(((xf - x1(4)).^2) + (yf + y1(4)).^2));

E1_yi5 = (rho1_i5/(2*pi*e_0)).*((yf - y1(5))./(((xf - x1(5)).^2) + (yf - y1(5)).^2) - (yf + y1(5))./(((xf - x1(5)).^2) + (yf + y1(5)).^2));
E1_yi6 = (rho1_i6/(2*pi*e_0)).*((yf - y1(6))./(((xf - x1(6)).^2) + (yf - y1(6)).^2) - (yf + y1(6))./(((xf - x1(6)).^2) + (yf + y1(6)).^2));
E1_yi7 = (rho1_i7/(2*pi*e_0)).*((yf - y1(7))./(((xf - x1(7)).^2) + (yf - y1(7)).^2) - (yf + y1(7))./(((xf - x1(7)).^2) + (yf + y1(7)).^2));
E1_yi8 = (rho1_i8/(2*pi*e_0)).*((yf - y1(8))./(((xf - x1(8)).^2) + (yf - y1(8)).^2) - (yf + y1(8))./(((xf - x1(8)).^2) + (yf + y1(8)).^2));

E1_yi9 = (rho1_i9/(2*pi*e_0)).*((yf - y1(9))./(((xf - x1(9)).^2) + (yf - y1(9)).^2) - (yf + y1(9))./(((xf - x1(9)).^2) + (yf + y1(9)).^2));
E1_yi10 = (rho1_i10/(2*pi*e_0)).*((yf - y1(10))./(((xf - x1(10)).^2) + (yf - y1(10)).^2) - (yf + y1(10))./(((xf - x1(10)).^2) + (yf + y1(10)).^2));
E1_yi11 = (rho1_i11/(2*pi*e_0)).*((yf - y1(11))./(((xf - x1(11)).^2) + (yf - y1(11)).^2) - (yf + y1(11))./(((xf - x1(11)).^2) + (yf + y1(11)).^2));
E1_yi12 = (rho1_i12/(2*pi*e_0)).*((yf - y1(12))./(((xf - x1(12)).^2) + (yf - y1(12)).^2) - (yf + y1(12))./(((xf - x1(12)).^2) + (yf + y1(12)).^2));

%% 

E1_xr = [ E1_xr1;  E1_xr2 ;  E1_xr3 ; E1_xr1 ; E1_xr5 ; E1_xr6 ; E1_xr7 ; E1_xr8 ; E1_xr9 ; E1_xr10 ; E1_xr11 ; E1_xr12 ];

E1_ximag = [ E1_xi1;  E1_xi2 ;  E1_xi3 ; E1_xi1 ; E1_xi5 ; E1_xi6 ; E1_xi7 ; E1_xi8 ; E1_xi9 ; E1_xi10 ; E1_xi11 ; E1_xi12 ];

E1_yr = [ E1_yr1;  E1_yr2 ;  E1_yr3 ; E1_yr1 ; E1_yr5 ; E1_yr6 ; E1_yr7 ; E1_yr8 ; E1_yr9 ; E1_yr10 ; E1_yr11 ; E1_yr12 ];

E1_yimag = [ E1_yi1;  E1_yi2 ;  E1_yi3 ; E1_yi1 ; E1_yi5 ; E1_yi6 ; E1_yi7 ; E1_yi8 ; E1_yi9 ; E1_yi10 ; E1_yi11 ; E1_yi12 ];

%%

E1xr = sum(E1_xr).^2;

E1ximag = sum(E1_ximag).^2;

E1yr = sum(E1_yr).^2;

E1yimag = sum(E1_yimag).^2;

E1rms = (E1xr+E1ximag+E1yr+E1yimag).^(1/2);

%%

P4 = zeros(n4,n4);
for i = 1:n4
     for j = 1:n4
        if(i==j)
           P4(i,j) = (1/(2*pi*e_0))*log((4*y4(i))/(2*r4));
        else
           P4(i,j) = (1/(2*pi*e_0))*log(sqrt((x4(j)-x4(i))^2+(yi4(j)-y4(i))^2)/(sqrt((x4(j)-x4(i))^2+(y4(j)-y4(i))^2)));
        end
     end
end

%%

V4 = 500*10^3;

V4_ra = V4/sqrt(3);
V4_ia = 0;

V4_rb = V4*(cos(2*pi/3))/sqrt(3);
V4_ib = 1i*V4*(sin(2*pi/3))/sqrt(3);

V4_rc = V4*(cos(-2*pi/3))/sqrt(3);
V4_ic = 1i*V4*(sin(-2*pi/3))/sqrt(3);

Vf4 = [ V4_ra+V4_ia ; V4_ra+V4_ia ; V4_ra+V4_ia ; V4_ra+V4_ia ; V4_rb+V4_ib ; V4_rb+V4_ib ; V4_rb+V4_ib ; V4_rb+V4_ib ; V4_rc+V4_ic ; V4_rc+V4_ic ; V4_rc+V4_ic ; V4_rc+V4_ic ];

%% 

rho4 = P4\Vf4;

%cabo 1 fase a
rho4_r1 = real(rho4(1)); 
rho4_i1 = imag(rho4(1));

%cabo 2 fase a
rho4_r2 = real(rho4(2));
rho4_i2 = imag(rho4(2));

%cabo 3 fase a
rho4_r3 = real(rho4(3));
rho4_i3 = imag(rho4(3));

%cabo 4 fase a
rho4_r4 = real(rho4(4));
rho4_i4 = imag(rho4(4));

%cabo 5 fase b
rho4_r5 = real(rho4(5));
rho4_i5 = imag(rho4(5));

%cabo 6 fase b
rho4_r6 = real(rho4(6));
rho4_i6 = imag(rho4(6));

%cabo 7 fase b
rho4_r7 = real(rho4(7));
rho4_i7 = imag(rho4(7));

%cabo 8 fase b
rho4_r8 = real(rho4(8));
rho4_i8 = imag(rho4(8));

%cabo 9 fase c
rho4_r9 = real(rho4(9));
rho4_i9 = imag(rho4(9));

%cabo 10 fase c
rho4_r10 = real(rho4(10));
rho4_i10 = imag(rho4(10));

%cabo 11 fase c
rho4_r11 = real(rho4(11));
rho4_i11 = imag(rho4(11));

%cabo 12 fase c
rho4_r12 = real(rho4(12));
rho4_i12 = imag(rho4(12));

%% 

E4_xr1 = (rho4_r1/(2*pi*e_0)).*((xf - x4(1))./(((xf - x4(1)).^2) + (yf - y4(1)).^2) - (xf - x4(1))./(((xf - x4(1)).^2) + (yf + y4(1)).^2));
E4_xr2 = (rho4_r2/(2*pi*e_0)).*((xf - x4(2))./(((xf - x4(2)).^2) + (yf - y4(2)).^2) - (xf - x4(2))./(((xf - x4(2)).^2) + (yf + y4(2)).^2));
E4_xr3 = (rho4_r3/(2*pi*e_0)).*((xf - x4(3))./(((xf - x4(3)).^2) + (yf - y4(3)).^2) - (xf - x4(3))./(((xf - x4(3)).^2) + (yf + y4(3)).^2));
E4_xr4 = (rho4_r4/(2*pi*e_0)).*((xf - x4(4))./(((xf - x4(4)).^2) + (yf - y4(4)).^2) - (xf - x4(4))./(((xf - x4(4)).^2) + (yf + y4(4)).^2));

E4_xr5 = (rho4_r5/(2*pi*e_0)).*((xf - x4(5))./(((xf - x4(5)).^2) + (yf - y4(5)).^2) - (xf - x4(5))./(((xf - x4(5)).^2) + (yf + y4(5)).^2));
E4_xr6 = (rho4_r6/(2*pi*e_0)).*((xf - x4(6))./(((xf - x4(6)).^2) + (yf - y4(6)).^2) - (xf - x4(6))./(((xf - x4(6)).^2) + (yf + y4(6)).^2));
E4_xr7 = (rho4_r7/(2*pi*e_0)).*((xf - x4(7))./(((xf - x4(7)).^2) + (yf - y4(7)).^2) - (xf - x4(7))./(((xf - x4(7)).^2) + (yf + y4(7)).^2));
E4_xr8 = (rho4_r8/(2*pi*e_0)).*((xf - x4(8))./(((xf - x4(8)).^2) + (yf - y4(8)).^2) - (xf - x4(8))./(((xf - x4(8)).^2) + (yf + y4(8)).^2));

E4_xr9 = (rho4_r9/(2*pi*e_0)).*((xf - x4(9))./(((xf - x4(9)).^2) + (yf - y4(9)).^2) - (xf - x4(9))./(((xf - x4(9)).^2) + (yf + y4(9)).^2));
E4_xr10 = (rho4_r10/(2*pi*e_0)).*((xf - x4(10))./(((xf - x4(10)).^2) + (yf - y4(10)).^2) - (xf - x4(10))./(((xf - x4(10)).^2) + (yf + y4(10)).^2));
E4_xr11 = (rho4_r11/(2*pi*e_0)).*((xf - x4(11))./(((xf - x4(11)).^2) + (yf - y4(11)).^2) - (xf - x4(11))./(((xf - x4(11)).^2) + (yf + y4(11)).^2));
E4_xr12 = (rho4_r12/(2*pi*e_0)).*((xf - x4(12))./(((xf - x4(12)).^2) + (yf - y4(12)).^2) - (xf - x4(12))./(((xf - x4(12)).^2) + (yf + y4(12)).^2));

%%

E4_xi1 = (rho4_i1/(2*pi*e_0)).*((xf - x4(1))./(((xf - x4(1)).^2) + (yf - y4(1)).^2) - (xf - x4(1))./(((xf - x4(1)).^2) + (yf + y4(1)).^2));
E4_xi2 = (rho4_i2/(2*pi*e_0)).*((xf - x4(2))./(((xf - x4(2)).^2) + (yf - y4(2)).^2) - (xf - x4(2))./(((xf - x4(2)).^2) + (yf + y4(2)).^2));
E4_xi3 = (rho4_i3/(2*pi*e_0)).*((xf - x4(3))./(((xf - x4(3)).^2) + (yf - y4(3)).^2) - (xf - x4(3))./(((xf - x4(3)).^2) + (yf + y4(3)).^2));
E4_xi4 = (rho4_i4/(2*pi*e_0)).*((xf - x4(4))./(((xf - x4(4)).^2) + (yf - y4(4)).^2) - (xf - x4(4))./(((xf - x4(4)).^2) + (yf + y4(4)).^2));

E4_xi5 = (rho4_i5/(2*pi*e_0)).*((xf - x4(5))./(((xf - x4(5)).^2) + (yf - y4(5)).^2) - (xf - x4(5))./(((xf - x4(5)).^2) + (yf + y4(5)).^2));
E4_xi6 = (rho4_i6/(2*pi*e_0)).*((xf - x4(6))./(((xf - x4(6)).^2) + (yf - y4(6)).^2) - (xf - x4(6))./(((xf - x4(6)).^2) + (yf + y4(6)).^2));
E4_xi7 = (rho4_i7/(2*pi*e_0)).*((xf - x4(7))./(((xf - x4(7)).^2) + (yf - y4(7)).^2) - (xf - x4(7))./(((xf - x4(7)).^2) + (yf + y4(7)).^2));
E4_xi8 = (rho4_i8/(2*pi*e_0)).*((xf - x4(8))./(((xf - x4(8)).^2) + (yf - y4(8)).^2) - (xf - x4(8))./(((xf - x4(8)).^2) + (yf + y4(8)).^2));

E4_xi9 = (rho4_i9/(2*pi*e_0)).*((xf - x4(7))./(((xf - x4(9)).^2) + (yf - y4(9)).^2) - (xf - x4(9))./(((xf - x4(9)).^2) + (yf + y4(9)).^2));
E4_xi10 = (rho4_i10/(2*pi*e_0)).*((xf - x4(10))./(((xf - x4(10)).^2) + (yf - y4(10)).^2) - (xf - x4(10))./(((xf - x4(10)).^2) + (yf + y4(10)).^2));
E4_xi11 = (rho4_i11/(2*pi*e_0)).*((xf - x4(11))./(((xf - x4(11)).^2) + (yf - y4(11)).^2) - (xf - x4(11))./(((xf - x4(11)).^2) + (yf + y4(11)).^2));
E4_xi12 = (rho4_i12/(2*pi*e_0)).*((xf - x4(12))./(((xf - x4(12)).^2) + (yf - y4(12)).^2) - (xf - x4(12))./(((xf - x4(12)).^2) + (yf + y4(12)).^2));

%%

E4_yr1 = (rho4_r1/(2*pi*e_0)).*((yf - y4(1))./(((xf - x4(1)).^2) + (yf - y4(1)).^2) - (yf + y4(1))./(((xf - x4(1)).^2) + (yf + y4(1)).^2));
E4_yr2 = (rho4_r2/(2*pi*e_0)).*((yf - y4(2))./(((xf - x4(2)).^2) + (yf - y4(2)).^2) - (yf + y4(2))./(((xf - x4(2)).^2) + (yf + y4(2)).^2));
E4_yr3 = (rho4_r3/(2*pi*e_0)).*((yf - y4(3))./(((xf - x4(3)).^2) + (yf - y4(3)).^2) - (yf + y4(3))./(((xf - x4(3)).^2) + (yf + y4(3)).^2));
E4_yr4 = (rho4_r4/(2*pi*e_0)).*((yf - y4(4))./(((xf - x4(4)).^2) + (yf - y4(4)).^2) - (yf + y4(4))./(((xf - x4(4)).^2) + (yf + y4(4)).^2));

E4_yr5 = (rho4_r5/(2*pi*e_0)).*((yf - y4(5))./(((xf - x4(5)).^2) + (yf - y4(5)).^2) - (yf + y4(5))./(((xf - x4(5)).^2) + (yf + y4(5)).^2));
E4_yr6 = (rho4_r6/(2*pi*e_0)).*((yf - y4(6))./(((xf - x4(6)).^2) + (yf - y4(6)).^2) - (yf + y4(6))./(((xf - x4(6)).^2) + (yf + y4(6)).^2));
E4_yr7 = (rho4_r7/(2*pi*e_0)).*((yf - y4(7))./(((xf - x4(7)).^2) + (yf - y4(7)).^2) - (yf + y4(7))./(((xf - x4(7)).^2) + (yf + y4(7)).^2));
E4_yr8 = (rho4_r8/(2*pi*e_0)).*((yf - y4(8))./(((xf - x4(8)).^2) + (yf - y4(8)).^2) - (yf + y4(8))./(((xf - x4(8)).^2) + (yf + y4(8)).^2));

E4_yr9 = (rho4_r9/(2*pi*e_0)).*((yf - y4(9))./(((xf - x4(9)).^2) + (yf - y4(9)).^2) - (yf + y4(9))./(((xf - x4(9)).^2) + (yf + y4(9)).^2));
E4_yr10 = (rho4_r10/(2*pi*e_0)).*((yf - y4(10))./(((xf - x4(10)).^2) + (yf - y4(10)).^2) - (yf + y4(10))./(((xf - x4(10)).^2) + (yf + y4(10)).^2));
E4_yr11 = (rho4_r11/(2*pi*e_0)).*((yf - y4(11))./(((xf - x4(11)).^2) + (yf - y4(11)).^2) - (yf + y4(11))./(((xf - x4(11)).^2) + (yf + y4(11)).^2));
E4_yr12 = (rho4_r12/(2*pi*e_0)).*((yf - y4(12))./(((xf - x4(12)).^2) + (yf - y4(12)).^2) - (yf + y4(12))./(((xf - x4(12)).^2) + (yf + y4(12)).^2));

%%

E4_yi1 = (rho4_i1/(2*pi*e_0)).*((yf - y4(1))./(((xf - x4(1)).^2) + (yf - y4(1)).^2) - (yf + y4(1))./(((xf - x4(1)).^2) + (yf + y4(1)).^2));
E4_yi2 = (rho4_i2/(2*pi*e_0)).*((yf - y4(2))./(((xf - x4(2)).^2) + (yf - y4(2)).^2) - (yf + y4(2))./(((xf - x4(2)).^2) + (yf + y4(2)).^2));
E4_yi3 = (rho4_i3/(2*pi*e_0)).*((yf - y4(3))./(((xf - x4(3)).^2) + (yf - y4(3)).^2) - (yf + y4(3))./(((xf - x4(3)).^2) + (yf + y4(3)).^2));
E4_yi4 = (rho4_i4/(2*pi*e_0)).*((yf - y4(4))./(((xf - x4(4)).^2) + (yf - y4(4)).^2) - (yf + y4(4))./(((xf - x4(4)).^2) + (yf + y4(4)).^2));

E4_yi5 = (rho4_i5/(2*pi*e_0)).*((yf - y4(5))./(((xf - x4(5)).^2) + (yf - y4(5)).^2) - (yf + y4(5))./(((xf - x4(5)).^2) + (yf + y4(5)).^2));
E4_yi6 = (rho4_i6/(2*pi*e_0)).*((yf - y4(6))./(((xf - x4(6)).^2) + (yf - y4(6)).^2) - (yf + y4(6))./(((xf - x4(6)).^2) + (yf + y4(6)).^2));
E4_yi7 = (rho4_i7/(2*pi*e_0)).*((yf - y4(7))./(((xf - x4(7)).^2) + (yf - y4(7)).^2) - (yf + y4(7))./(((xf - x4(7)).^2) + (yf + y4(7)).^2));
E4_yi8 = (rho4_i8/(2*pi*e_0)).*((yf - y4(8))./(((xf - x4(8)).^2) + (yf - y4(8)).^2) - (yf + y4(8))./(((xf - x4(8)).^2) + (yf + y4(8)).^2));

E4_yi9 = (rho4_i9/(2*pi*e_0)).*((yf - y4(9))./(((xf - x4(9)).^2) + (yf - y4(9)).^2) - (yf + y4(9))./(((xf - x4(9)).^2) + (yf + y4(9)).^2));
E4_yi10 = (rho4_i10/(2*pi*e_0)).*((yf - y4(10))./(((xf - x4(10)).^2) + (yf - y4(10)).^2) - (yf + y4(10))./(((xf - x4(10)).^2) + (yf + y4(10)).^2));
E4_yi11 = (rho4_i11/(2*pi*e_0)).*((yf - y4(11))./(((xf - x4(11)).^2) + (yf - y4(11)).^2) - (yf + y4(11))./(((xf - x4(11)).^2) + (yf + y4(11)).^2));
E4_yi12 = (rho4_i12/(2*pi*e_0)).*((yf - y4(12))./(((xf - x4(12)).^2) + (yf - y4(12)).^2) - (yf + y4(12))./(((xf - x4(12)).^2) + (yf + y4(12)).^2));

%% 

E4_xr = [ E4_xr1;  E4_xr2 ;  E4_xr3 ; E4_xr4 ; E4_xr5 ; E4_xr6 ; E4_xr7 ; E4_xr8 ; E4_xr9 ; E4_xr10 ; E4_xr11 ; E4_xr12 ];

E4_ximag = [ E4_xi1;  E4_xi2 ;  E4_xi3 ; E4_xi4 ; E4_xi5 ; E4_xi6 ; E4_xi7 ; E4_xi8 ; E4_xi9 ; E4_xi10 ; E4_xi11 ; E4_xi12 ];

E4_yr = [ E4_yr1;  E4_yr2 ;  E4_yr3 ; E4_yr4 ; E4_yr5 ; E4_yr6 ; E4_yr7 ; E4_yr8 ; E4_yr9 ; E4_yr10 ; E4_yr11 ; E4_yr12 ];

E4_yimag = [ E4_yi1;  E4_yi2 ;  E4_yi3 ; E4_yi4 ; E4_yi5 ; E4_yi6 ; E4_yi7 ; E4_yi8 ; E4_yi9 ; E4_yi10 ; E4_yi11 ; E4_yi12 ];


%%
E4xr = sum(E4_xr).^2;

E4ximag = sum(E4_ximag).^2;

E4yr = sum(E4_yr).^2;

E4yimag = sum(E4_yimag).^2;

E4rms = (E4xr+E4ximag+E4yr+E4yimag).^(1/2);

%%

Enorma = linspace(8330,8330,100);

E4rms_or = [2220.10530491133 2297.05824510243 2376.22034700783 2457.52362010670 2540.87623147735 2626.15957595027 2713.22519866164 2801.89160439989 2891.94100042606 2983.11603355914 3075.11659816693 3167.59680907762 3260.16225194631 3352.36764269565 3443.71504649060 3533.65282424886 3621.57548962349 3706.82467018880 3788.69137151374 3866.41974014423 3939.21250954342 4006.23829033534 4066.64083185793 4119.55033594053 4164.09684692940 4199.42567656742 4224.71475216755 4239.19370695548 4242.16446932342 4233.02306105256 4211.28229201761 4176.59504910240 4128.77792756884 4067.83504905888 3993.98205263712 3907.67042759437 3809.61256118147 3700.80806316729 3582.57203002287 3456.56579416212 3324.83014180780 3189.81960606965 3054.43369638469 2922.03612155909 2796.44568424927 2681.87311431135 2582.77000907781 2503.55740849767 2448.22465284260 2419.84182871881 2420.09713242580 2449.00887935291 2504.92317558943 2584.79798358597 2684.66358397040 2800.10979578738 2926.68803564255 3060.18418487511 3196.77111155896 3333.07309206925 3466.17592339979 3593.60850091404 3713.31224390506 3823.60736184945 3923.16013299273 4010.95260575050 4086.25474490593 4148.59847542536 4197.75295553339 4233.70051043763 4256.61284755898 4266.82738056845 4264.82367454817 4251.20016976892 4226.65144032813 4191.94629680327 4147.90705408593 4095.39026411966 4035.26916698079 3968.41805137196 3895.69864527018 3817.94858615248 3735.97195340791 3650.53178715003 3562.34447005904 3472.07581315112 3380.33866244104 3287.69183046550 3194.64015316069 3101.63547694115 3009.07839121615 2917.32053627840 2826.66733394508 2737.38100718579 2649.68377415226 2563.76112069589 2479.76507302042 2397.81740817123 2318.01275438162 2240.42154578734];

h = figure();
plot(xf,E4rms_or,'-','LineWidth',3.5)
xlabel('Faixa de passagem (m)')
ylabel('Campo elétrico (V/m)')
grid
hold on
plot(xf,E1rms,':','LineWidth',3.5)
hold on
plot(xf,E4rms,'-.','LineWidth',3.5)
hold on
plot(xf,Enorma,'--','LineWidth',3.5)
legend('Original','Aprox. 1 m', 'Aprox. 2 m', 'Limite da norma')
set(gca, 'YScale', 'log')
ylim([0 9000])

set(h,'Units','Inches');
pos = get(h,'Position');
set(h,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[pos(3), pos(4)])
%print(h,'solo_caso1_dist','-dpdf','-r0')

% xr1 = [-3 0 3];
% yr1 = [11.01 11.01 11.01];

% xr2 = [-10.178 -10.25 -0.228 0 10.022 10.25];
% yr2 = [11.290 11.290 11.290 11.290 11.290 11.290];

% xr3 = [-10.178 -10.25 -10.021 -0.228 0 0.228 10.021 10.25 10.178];
% yr3 = [16.530 16.758 16.530 16.530 16.758 16.530 16.530 16.758 16.530];

xr4 = [-7.975 -7.025 -7.025 -7.975 -0.475 0.475 0.475 -0.475 7.025 7.975 7.975 7.025];
yr4 = [18.45 18.45 17.5 17.5 25.95 25.95 25 25 18.45 18.45 17.5 17.5];

g = figure();
plot(xr4,yr4,'o','color','b')
xlabel('Faixa de passagem (m)')
ylabel('Altura dos cabos (m)')
grid
hold on
plot(x1,y1,'*','color','r')
hold on
plot(x4,y4,'x','color','r')
legend('Original','Aprox. 1 m', 'Aprox. 2 m')
% xlim([-3.5 3.5])
ylim([17 27])

set(g,'Units','Inches');
pos = get(g,'Position');
set(g,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[pos(3), pos(4)])
print(g,'solo_caso4_dist_config','-dpdf','-r0')