% faixa de passagem = 1.5 m
% norma campo elétrico ao nível do solo = 8.33 kV/m
% ACIMA e ABAIXO 2 m em y da configuração original

clear all; close all; clc

var = 2;
e_0 = 8.854*(10^(-12));
%faixa de passagem
xf = linspace(-25,25,100);
yf = 1.5;

%% ACIMA

n1 = 9;
r1 = 1.437*(10^(-2));

x1 = [-10.478 -10.25 -10.021 -0.228 0 0.228 10.021 10.25 10.478];
y1 = [16.530 16.758 16.530 16.530 16.758 16.530 16.530 16.758 16.530]+var;
yi1 = -y1;

%% ABAIXO

n3 = 9;
r3 = 1.437*(10^(-2));

x3 = [-10.478 -10.25 -10.021 -0.228 0 0.228 10.021 10.25 10.478];
y3 = [16.530 16.758 16.530 16.530 16.758 16.530 16.530 16.758 16.530]-var;
yi3 = -y3;


%%

P1 = zeros(n1,n1);
for i = 1:n1
     for j = 1:n1
        if(i==j)
           P1(i,j) = (1/(2*pi*e_0))*log((4*y1(i))/(2*r1));
        else
           P1(i,j) = (1/(2*pi*e_0))*log(sqrt((x1(j)-x1(i))^2+(yi1(j)-y1(i))^2)/(sqrt((x1(j)-x1(i))^2+(y1(j)-y1(i))^2)));
        end
     end
end


%%
V1 = 500*10^3;

V1_ra = V1/sqrt(3);
V1_ia = 0;

V1_rb = V1*(cos(2*pi/3))/sqrt(3);
V1_ib = 1i*V1*(sin(2*pi/3))/sqrt(3);

V1_rc = V1*(cos(-2*pi/3))/sqrt(3);
V1_ic = 1i*V1*(sin(-2*pi/3))/sqrt(3);

Vf1 = [ V1_ra+V1_ia ; V1_ra+V1_ia ; V1_ra+V1_ia ; V1_rb+V1_ib ; V1_rb+V1_ib ; V1_rb+V1_ib ; V1_rc+V1_ic ; V1_rc+V1_ic ; V1_rc+V1_ic ];

%%

rho1 = P1\Vf1;

rho1_r1 = real(rho1(1)); 
rho1_i1 = imag(rho1(1));

rho1_r2 = real(rho1(2));
rho1_i2 = imag(rho1(2));

rho1_r3 = real(rho1(3));
rho1_i3 = imag(rho1(3));

rho1_r4 = real(rho1(4));
rho1_i4 = imag(rho1(4));

rho1_r5 = real(rho1(5));
rho1_i5 = imag(rho1(5));

rho1_r6 = real(rho1(6));
rho1_i6 = imag(rho1(6));

rho1_r7 = real(rho1(7));
rho1_i7 = imag(rho1(7));

rho1_r8 = real(rho1(8));
rho1_i8 = imag(rho1(8));

rho1_r9 = real(rho1(9));
rho1_i9 = imag(rho1(9));

%%

E1_xr1 = (rho1_r1/(2*pi*e_0)).*((xf - x1(1))./(((xf - x1(1)).^2) + (yf - y1(1)).^2) - (xf - x1(1))./(((xf - x1(1)).^2) + (yf + y1(1)).^2));
E1_xr2 = (rho1_r2/(2*pi*e_0)).*((xf - x1(2))./(((xf - x1(2)).^2) + (yf - y1(2)).^2) - (xf - x1(2))./(((xf - x1(2)).^2) + (yf + y1(2)).^2));
E1_xr3 = (rho1_r3/(2*pi*e_0)).*((xf - x1(3))./(((xf - x1(3)).^2) + (yf - y1(3)).^2) - (xf - x1(3))./(((xf - x1(3)).^2) + (yf + y1(3)).^2));
E1_xr4 = (rho1_r4/(2*pi*e_0)).*((xf - x1(4))./(((xf - x1(4)).^2) + (yf - y1(4)).^2) - (xf - x1(4))./(((xf - x1(4)).^2) + (yf + y1(4)).^2));
E1_xr5 = (rho1_r5/(2*pi*e_0)).*((xf - x1(5))./(((xf - x1(5)).^2) + (yf - y1(5)).^2) - (xf - x1(5))./(((xf - x1(5)).^2) + (yf + y1(5)).^2));
E1_xr6 = (rho1_r6/(2*pi*e_0)).*((xf - x1(6))./(((xf - x1(6)).^2) + (yf - y1(6)).^2) - (xf - x1(6))./(((xf - x1(6)).^2) + (yf + y1(6)).^2));
E1_xr7 = (rho1_r7/(2*pi*e_0)).*((xf - x1(7))./(((xf - x1(7)).^2) + (yf - y1(7)).^2) - (xf - x1(7))./(((xf - x1(7)).^2) + (yf + y1(7)).^2));
E1_xr8 = (rho1_r8/(2*pi*e_0)).*((xf - x1(8))./(((xf - x1(8)).^2) + (yf - y1(8)).^2) - (xf - x1(8))./(((xf - x1(8)).^2) + (yf + y1(8)).^2));
E1_xr9 = (rho1_r9/(2*pi*e_0)).*((xf - x1(9))./(((xf - x1(9)).^2) + (yf - y1(9)).^2) - (xf - x1(9))./(((xf - x1(9)).^2) + (yf + y1(9)).^2));

E1_xi1 = (rho1_i1/(2*pi*e_0)).*((xf - x1(1))./(((xf - x1(1)).^2) + (yf - y1(1)).^2) - (xf - x1(1))./(((xf - x1(1)).^2) + (yf + y1(1)).^2));
E1_xi2 = (rho1_i2/(2*pi*e_0)).*((xf - x1(2))./(((xf - x1(2)).^2) + (yf - y1(2)).^2) - (xf - x1(2))./(((xf - x1(2)).^2) + (yf + y1(2)).^2));
E1_xi3 = (rho1_i3/(2*pi*e_0)).*((xf - x1(3))./(((xf - x1(3)).^2) + (yf - y1(3)).^2) - (xf - x1(3))./(((xf - x1(3)).^2) + (yf + y1(3)).^2));
E1_xi4 = (rho1_i4/(2*pi*e_0)).*((xf - x1(4))./(((xf - x1(4)).^2) + (yf - y1(4)).^2) - (xf - x1(4))./(((xf - x1(4)).^2) + (yf + y1(4)).^2));
E1_xi5 = (rho1_i5/(2*pi*e_0)).*((xf - x1(5))./(((xf - x1(5)).^2) + (yf - y1(5)).^2) - (xf - x1(5))./(((xf - x1(5)).^2) + (yf + y1(5)).^2));
E1_xi6 = (rho1_i6/(2*pi*e_0)).*((xf - x1(6))./(((xf - x1(6)).^2) + (yf - y1(6)).^2) - (xf - x1(6))./(((xf - x1(6)).^2) + (yf + y1(6)).^2));
E1_xi7 = (rho1_i7/(2*pi*e_0)).*((xf - x1(7))./(((xf - x1(7)).^2) + (yf - y1(7)).^2) - (xf - x1(7))./(((xf - x1(7)).^2) + (yf + y1(7)).^2));
E1_xi8 = (rho1_i8/(2*pi*e_0)).*((xf - x1(8))./(((xf - x1(8)).^2) + (yf - y1(8)).^2) - (xf - x1(8))./(((xf - x1(8)).^2) + (yf + y1(8)).^2));
E1_xi9 = (rho1_i9/(2*pi*e_0)).*((xf - x1(9))./(((xf - x1(9)).^2) + (yf - y1(9)).^2) - (xf - x1(9))./(((xf - x1(9)).^2) + (yf + y1(9)).^2));

E1_yr1 = (rho1_r1/(2*pi*e_0)).*((yf - y1(1))./(((xf - x1(1)).^2) + (yf - y1(1)).^2) - (yf + y1(1))./(((xf - x1(1)).^2) + (yf + y1(1)).^2));
E1_yr2 = (rho1_r2/(2*pi*e_0)).*((yf - y1(2))./(((xf - x1(2)).^2) + (yf - y1(2)).^2) - (yf + y1(2))./(((xf - x1(2)).^2) + (yf + y1(2)).^2));
E1_yr3 = (rho1_r3/(2*pi*e_0)).*((yf - y1(3))./(((xf - x1(3)).^2) + (yf - y1(3)).^2) - (yf + y1(3))./(((xf - x1(3)).^2) + (yf + y1(3)).^2));
E1_yr4 = (rho1_r4/(2*pi*e_0)).*((yf - y1(4))./(((xf - x1(4)).^2) + (yf - y1(4)).^2) - (yf + y1(4))./(((xf - x1(4)).^2) + (yf + y1(4)).^2));
E1_yr5 = (rho1_r5/(2*pi*e_0)).*((yf - y1(5))./(((xf - x1(5)).^2) + (yf - y1(5)).^2) - (yf + y1(5))./(((xf - x1(5)).^2) + (yf + y1(5)).^2));
E1_yr6 = (rho1_r6/(2*pi*e_0)).*((yf - y1(6))./(((xf - x1(6)).^2) + (yf - y1(6)).^2) - (yf + y1(6))./(((xf - x1(6)).^2) + (yf + y1(6)).^2));
E1_yr7 = (rho1_r7/(2*pi*e_0)).*((yf - y1(7))./(((xf - x1(7)).^2) + (yf - y1(7)).^2) - (yf + y1(7))./(((xf - x1(7)).^2) + (yf + y1(7)).^2));
E1_yr8 = (rho1_r8/(2*pi*e_0)).*((yf - y1(8))./(((xf - x1(8)).^2) + (yf - y1(8)).^2) - (yf + y1(8))./(((xf - x1(8)).^2) + (yf + y1(8)).^2));
E1_yr9 = (rho1_r9/(2*pi*e_0)).*((yf - y1(9))./(((xf - x1(9)).^2) + (yf - y1(9)).^2) - (yf + y1(9))./(((xf - x1(9)).^2) + (yf + y1(9)).^2));

E1_yi1 = (rho1_i1/(2*pi*e_0)).*((yf - y1(1))./(((xf - x1(1)).^2) + (yf - y1(1)).^2) - (yf + y1(1))./(((xf - x1(1)).^2) + (yf + y1(1)).^2));
E1_yi2 = (rho1_i2/(2*pi*e_0)).*((yf - y1(2))./(((xf - x1(2)).^2) + (yf - y1(2)).^2) - (yf + y1(2))./(((xf - x1(2)).^2) + (yf + y1(2)).^2));
E1_yi3 = (rho1_i3/(2*pi*e_0)).*((yf - y1(3))./(((xf - x1(3)).^2) + (yf - y1(3)).^2) - (yf + y1(3))./(((xf - x1(3)).^2) + (yf + y1(3)).^2));
E1_yi4 = (rho1_i4/(2*pi*e_0)).*((yf - y1(4))./(((xf - x1(4)).^2) + (yf - y1(4)).^2) - (yf + y1(4))./(((xf - x1(4)).^2) + (yf + y1(4)).^2));
E1_yi5 = (rho1_i5/(2*pi*e_0)).*((yf - y1(5))./(((xf - x1(5)).^2) + (yf - y1(5)).^2) - (yf + y1(5))./(((xf - x1(5)).^2) + (yf + y1(5)).^2));
E1_yi6 = (rho1_i6/(2*pi*e_0)).*((yf - y1(6))./(((xf - x1(6)).^2) + (yf - y1(6)).^2) - (yf + y1(6))./(((xf - x1(6)).^2) + (yf + y1(6)).^2));
E1_yi7 = (rho1_i7/(2*pi*e_0)).*((yf - y1(7))./(((xf - x3(7)).^2) + (yf - y1(7)).^2) - (yf + y1(7))./(((xf - x3(7)).^2) + (yf + y1(7)).^2));
E1_yi8 = (rho1_i8/(2*pi*e_0)).*((yf - y1(8))./(((xf - x3(8)).^2) + (yf - y1(8)).^2) - (yf + y1(8))./(((xf - x3(8)).^2) + (yf + y1(8)).^2));
E1_yi9 = (rho1_i9/(2*pi*e_0)).*((yf - y1(9))./(((xf - x3(9)).^2) + (yf - y1(9)).^2) - (yf + y1(9))./(((xf - x3(9)).^2) + (yf + y1(9)).^2));

%%

E1_xr = [ E1_xr1;  E1_xr2 ;  E1_xr3 ; E1_xr4 ; E1_xr5 ; E1_xr6 ; E1_xr7 ; E1_xr8 ; E1_xr9 ];

E1_ximag = [ E1_xi1;  E1_xi2 ;  E1_xi3 ; E1_xi4 ; E1_xi5 ; E1_xi6 ; E1_xi7 ; E1_xi8 ; E1_xi9 ];

E1_yr = [ E1_yr1;  E1_yr2 ;  E1_yr3 ; E1_yr4 ; E1_yr5 ; E1_yr6 ; E1_yr7 ; E1_yr8 ; E1_yr9 ];

E1_yimag = [ E1_yi1;  E1_yi2 ; E1_yi3 ; E1_yi4 ; E1_yi5 ; E1_yi6 ; E1_yi7 ; E1_yi8 ; E1_yi9 ];


%%

E1xr = sum(E1_xr).^2;

E1ximag = sum(E1_ximag).^2;

E1yr = sum(E1_yr).^2;

E1yimag = sum(E1_yimag).^2;

E1rms = (E1xr+E1ximag+E1yr+E1yimag).^(1/2);

%%

P3 = zeros(n3,n3);
for i = 1:n3
     for j = 1:n3
        if(i==j)
           P3(i,j) = (1/(2*pi*e_0))*log((4*y3(i))/(2*r3));
        else
           P3(i,j) = (1/(2*pi*e_0))*log(sqrt((x3(j)-x3(i))^2+(yi3(j)-y3(i))^2)/(sqrt((x3(j)-x3(i))^2+(y3(j)-y3(i))^2)));
        end
     end
end

%%

V3 = 500*10^3;

V3_ra = V3/sqrt(3);
V3_ia = 0;

V3_rb = V3*(cos(2*pi/3))/sqrt(3);
V3_ib = 1i*V3*(sin(2*pi/3))/sqrt(3);

V3_rc = V3*(cos(-2*pi/3))/sqrt(3);
V3_ic = 1i*V3*(sin(-2*pi/3))/sqrt(3);

Vf3 = [ V3_ra+V3_ia ; V3_ra+V3_ia ; V3_ra+V3_ia ; V3_rb+V3_ib ; V3_rb+V3_ib ; V3_rb+V3_ib ; V3_rc+V3_ic ; V3_rc+V3_ic ; V3_rc+V3_ic ];

%% AP : Funciona destas duas maneiras e a ultima é mais rápida a barra invertida indica inversão de P:

rho3 = P3\Vf3;

%busco cada uma das posicoes de rho real e imaginario (ver indice)

%cabo 1 fase a
rho3_r1 = real(rho3(1)); 
rho3_i1 = imag(rho3(1));

%cabo 2 fase a
rho3_r2 = real(rho3(2));
rho3_i2 = imag(rho3(2));

%cabo 3 fase a
rho3_r3 = real(rho3(3));
rho3_i3 = imag(rho3(3));

%cabo 4 fase b
rho3_r4 = real(rho3(4));
rho3_i4 = imag(rho3(4));

%cabo 5 fase b
rho3_r5 = real(rho3(5));
rho3_i5 = imag(rho3(5));

%cabo 6 fase b
rho3_r6 = real(rho3(6));
rho3_i6 = imag(rho3(6));

%cabo 7 fase c
rho3_r7 = real(rho3(7));
rho3_i7 = imag(rho3(7));

%cabo 8 fase c
rho3_r8 = real(rho3(8));
rho3_i8 = imag(rho3(8));

%cabo 9 fase c
rho3_r9 = real(rho3(9));
rho3_i9 = imag(rho3(9));


%% 

E3_xr1 = (rho3_r1/(2*pi*e_0)).*((xf - x3(1))./(((xf - x3(1)).^2) + (yf - y3(1)).^2) - (xf - x3(1))./(((xf - x3(1)).^2) + (yf + y3(1)).^2));
E3_xr2 = (rho3_r2/(2*pi*e_0)).*((xf - x3(2))./(((xf - x3(2)).^2) + (yf - y3(2)).^2) - (xf - x3(2))./(((xf - x3(2)).^2) + (yf + y3(2)).^2));
E3_xr3 = (rho3_r3/(2*pi*e_0)).*((xf - x3(3))./(((xf - x3(3)).^2) + (yf - y3(3)).^2) - (xf - x3(3))./(((xf - x3(3)).^2) + (yf + y3(3)).^2));

E3_xr4 = (rho3_r4/(2*pi*e_0)).*((xf - x3(4))./(((xf - x3(4)).^2) + (yf - y3(4)).^2) - (xf - x3(4))./(((xf - x3(4)).^2) + (yf + y3(4)).^2));
E3_xr5 = (rho3_r5/(2*pi*e_0)).*((xf - x3(5))./(((xf - x3(5)).^2) + (yf - y3(5)).^2) - (xf - x3(5))./(((xf - x3(5)).^2) + (yf + y3(5)).^2));
E3_xr6 = (rho3_r6/(2*pi*e_0)).*((xf - x3(6))./(((xf - x3(6)).^2) + (yf - y3(6)).^2) - (xf - x3(6))./(((xf - x3(6)).^2) + (yf + y3(6)).^2));

E3_xr7 = (rho3_r7/(2*pi*e_0)).*((xf - x3(7))./(((xf - x3(7)).^2) + (yf - y3(7)).^2) - (xf - x3(7))./(((xf - x3(7)).^2) + (yf + y3(7)).^2));
E3_xr8 = (rho3_r8/(2*pi*e_0)).*((xf - x3(8))./(((xf - x3(8)).^2) + (yf - y3(8)).^2) - (xf - x3(8))./(((xf - x3(8)).^2) + (yf + y3(8)).^2));
E3_xr9 = (rho3_r9/(2*pi*e_0)).*((xf - x3(9))./(((xf - x3(9)).^2) + (yf - y3(9)).^2) - (xf - x3(9))./(((xf - x3(9)).^2) + (yf + y3(9)).^2));


E3_xi1 = (rho3_i1/(2*pi*e_0)).*((xf - x3(1))./(((xf - x3(1)).^2) + (yf - y3(1)).^2) - (xf - x3(1))./(((xf - x3(1)).^2) + (yf + y3(1)).^2));
E3_xi2 = (rho3_i2/(2*pi*e_0)).*((xf - x3(2))./(((xf - x3(2)).^2) + (yf - y3(2)).^2) - (xf - x3(2))./(((xf - x3(2)).^2) + (yf + y3(2)).^2));
E3_xi3 = (rho3_i3/(2*pi*e_0)).*((xf - x3(3))./(((xf - x3(3)).^2) + (yf - y3(3)).^2) - (xf - x3(3))./(((xf - x3(3)).^2) + (yf + y3(3)).^2));

E3_xi4 = (rho3_i4/(2*pi*e_0)).*((xf - x3(4))./(((xf - x3(4)).^2) + (yf - y3(4)).^2) - (xf - x3(4))./(((xf - x3(4)).^2) + (yf + y3(4)).^2));
E3_xi5 = (rho3_i5/(2*pi*e_0)).*((xf - x3(5))./(((xf - x3(5)).^2) + (yf - y3(5)).^2) - (xf - x3(5))./(((xf - x3(5)).^2) + (yf + y3(5)).^2));
E3_xi6 = (rho3_i6/(2*pi*e_0)).*((xf - x3(6))./(((xf - x3(6)).^2) + (yf - y3(6)).^2) - (xf - x3(6))./(((xf - x3(6)).^2) + (yf + y3(6)).^2));

E3_xi7 = (rho3_i7/(2*pi*e_0)).*((xf - x3(7))./(((xf - x3(7)).^2) + (yf - y3(7)).^2) - (xf - x3(7))./(((xf - x3(7)).^2) + (yf + y3(7)).^2));
E3_xi8 = (rho3_i8/(2*pi*e_0)).*((xf - x3(8))./(((xf - x3(8)).^2) + (yf - y3(8)).^2) - (xf - x3(8))./(((xf - x3(8)).^2) + (yf + y3(8)).^2));
E3_xi9 = (rho3_i9/(2*pi*e_0)).*((xf - x3(9))./(((xf - x3(9)).^2) + (yf - y3(9)).^2) - (xf - x3(9))./(((xf - x3(9)).^2) + (yf + y3(9)).^2));


E3_yr1 = (rho3_r1/(2*pi*e_0)).*((yf - y3(1))./(((xf - x3(1)).^2) + (yf - y3(1)).^2) - (yf + y3(1))./(((xf - x3(1)).^2) + (yf + y3(1)).^2));
E3_yr2 = (rho3_r2/(2*pi*e_0)).*((yf - y3(2))./(((xf - x3(2)).^2) + (yf - y3(2)).^2) - (yf + y3(2))./(((xf - x3(2)).^2) + (yf + y3(2)).^2));
E3_yr3 = (rho3_r3/(2*pi*e_0)).*((yf - y3(3))./(((xf - x3(3)).^2) + (yf - y3(3)).^2) - (yf + y3(3))./(((xf - x3(3)).^2) + (yf + y3(3)).^2));

E3_yr4 = (rho3_r4/(2*pi*e_0)).*((yf - y3(4))./(((xf - x3(4)).^2) + (yf - y3(4)).^2) - (yf + y3(4))./(((xf - x3(4)).^2) + (yf + y3(4)).^2));
E3_yr5 = (rho3_r5/(2*pi*e_0)).*((yf - y3(5))./(((xf - x3(5)).^2) + (yf - y3(5)).^2) - (yf + y3(5))./(((xf - x3(5)).^2) + (yf + y3(5)).^2));
E3_yr6 = (rho3_r6/(2*pi*e_0)).*((yf - y3(6))./(((xf - x3(6)).^2) + (yf - y3(6)).^2) - (yf + y3(6))./(((xf - x3(6)).^2) + (yf + y3(6)).^2));

E3_yr7 = (rho3_r7/(2*pi*e_0)).*((yf - y3(7))./(((xf - x3(7)).^2) + (yf - y3(7)).^2) - (yf + y3(7))./(((xf - x3(7)).^2) + (yf + y3(7)).^2));
E3_yr8 = (rho3_r8/(2*pi*e_0)).*((yf - y3(8))./(((xf - x3(8)).^2) + (yf - y3(8)).^2) - (yf + y3(8))./(((xf - x3(8)).^2) + (yf + y3(8)).^2));
E3_yr9 = (rho3_r9/(2*pi*e_0)).*((yf - y3(9))./(((xf - x3(9)).^2) + (yf - y3(9)).^2) - (yf + y3(9))./(((xf - x3(9)).^2) + (yf + y3(9)).^2));


E3_yi1 = (rho3_i1/(2*pi*e_0)).*((yf - y3(1))./(((xf - x3(1)).^2) + (yf - y3(1)).^2) - (yf + y3(1))./(((xf - x3(1)).^2) + (yf + y3(1)).^2));
E3_yi2 = (rho3_i2/(2*pi*e_0)).*((yf - y3(2))./(((xf - x3(2)).^2) + (yf - y3(2)).^2) - (yf + y3(2))./(((xf - x3(2)).^2) + (yf + y3(2)).^2));
E3_yi3 = (rho3_i3/(2*pi*e_0)).*((yf - y3(3))./(((xf - x3(3)).^2) + (yf - y3(3)).^2) - (yf + y3(3))./(((xf - x3(3)).^2) + (yf + y3(3)).^2));

E3_yi4 = (rho3_i4/(2*pi*e_0)).*((yf - y3(4))./(((xf - x3(4)).^2) + (yf - y3(4)).^2) - (yf + y3(4))./(((xf - x3(4)).^2) + (yf + y3(4)).^2));
E3_yi5 = (rho3_i5/(2*pi*e_0)).*((yf - y3(5))./(((xf - x3(5)).^2) + (yf - y3(5)).^2) - (yf + y3(5))./(((xf - x3(5)).^2) + (yf + y3(5)).^2));
E3_yi6 = (rho3_i6/(2*pi*e_0)).*((yf - y3(6))./(((xf - x3(6)).^2) + (yf - y3(6)).^2) - (yf + y3(6))./(((xf - x3(6)).^2) + (yf + y3(6)).^2));

E3_yi7 = (rho3_i7/(2*pi*e_0)).*((yf - y3(7))./(((xf - x3(7)).^2) + (yf - y3(7)).^2) - (yf + y3(7))./(((xf - x3(7)).^2) + (yf + y3(7)).^2));
E3_yi8 = (rho3_i8/(2*pi*e_0)).*((yf - y3(8))./(((xf - x3(8)).^2) + (yf - y3(8)).^2) - (yf + y3(8))./(((xf - x3(8)).^2) + (yf + y3(8)).^2));
E3_yi9 = (rho3_i9/(2*pi*e_0)).*((yf - y3(9))./(((xf - x3(9)).^2) + (yf - y3(9)).^2) - (yf + y3(9))./(((xf - x3(9)).^2) + (yf + y3(9)).^2));

%% AP: aqui em cada matriz dessa tem as componentes geradas na direção x e y, pela parte real e imaginária de cada carga elétrica:

E3_xr = [ E3_xr1; E3_xr2 ; E3_xr3 ; E3_xr4 ; E3_xr5 ; E3_xr6 ; E3_xr7 ; E3_xr8 ; E3_xr9 ];

E3_ximag = [ E3_xi1; E3_xi2 ; E3_xi3 ; E3_xi4 ; E3_xi5 ; E3_xi6 ; E3_xi7 ; E3_xi8 ; E3_xi9  ];

E3_yr = [ E3_yr1; E3_yr2 ; E3_yr3 ; E3_yr4 ; E3_yr5 ; E3_yr6 ; E3_yr7 ; E3_yr8 ; E3_yr9  ];

E3_yimag = [ E3_yi1; E3_yi2 ; E3_yi3 ; E3_yi4 ; E3_yi5 ; E3_yi6 ; E3_yi7 ; E3_yi8 ; E3_yi9 ];

%% AP: aqui somamos as componentes (elementos das colunas) em cada direção e elevamos ao quadrado

E3xr = sum(E3_xr).^2;

E3ximag = sum(E3_ximag).^2;

E3yr = sum(E3_yr).^2;

E3yimag = sum(E3_yimag).^2;

E3rms = (E3xr+E3ximag+E3yr+E3yimag).^(1/2);

%%

Enorma = linspace(8330,8330,100);

E3rms_or = [2419.41991202489 2500.77843200845 2583.79228885038 2668.27441599521 2753.99929907269 2840.69929695552 2928.06104376366 3015.72205504527 3103.26768851823 3190.22863810759 3276.07916821880 3360.23632140197 3442.06035441674 3520.85667231447 3595.87953420160 3666.33779427092 3731.40291394360 3790.21943242820 3841.91801144049 3885.63107444781 3920.51094279251 3945.75023402914 3960.60413807378 3964.41403322026 3956.63175778207 3936.84372637050 3904.79398485787 3860.40524550441 3803.79694089986 3735.29938500685 3655.46322893956 3565.06353990495 3465.09800110509 3356.77891276503 3241.51885429334 3120.91003294959 2996.69749092197 2870.74647789831 2745.00444331093 2621.45830261749 2502.08794146915 2388.81739821231 2283.46583687737 2187.70123473711 2103.00045909785 2030.61971499775 1971.57871294263 1926.65995324982 1896.42134111103 1881.21676704331 1881.21676704331 1896.42134111102 1926.65995324982 1971.57871294263 2030.61971499775 2103.00045909785 2187.70123473711 2283.46583687737 2388.81739821231 2502.08794146914 2621.45830261749 2745.00444331093 2870.74647789830 2996.69749092196 3120.91003294959 3241.51885429334 3356.77891276503 3465.09800110509 3565.06353990494 3655.46322893955 3735.29938500685 3803.79694089986 3860.40524550440 3904.79398485787 3936.84372637049 3956.63175778207 3964.41403322026 3960.60413807378 3945.75023402914 3920.51094279251 3885.63107444781 3841.91801144049 3790.21943242820 3731.40291394360 3666.33779427092 3595.87953420160 3520.85667231447 3442.06035441674 3360.23632140197 3276.07916821880 3190.22863810759 3103.26768851822 3015.72205504527 2928.06104376366 2840.69929695551 2753.99929907269 2668.27441599521 2583.79228885038 2500.77843200845 2419.41991202489];

h = figure();
plot(xf,E3rms_or,'-','LineWidth',3.5)
xlabel('Faixa de passagem (m)')
ylabel('Campo elétrico (V/m)')
grid
hold on
plot(xf,E1rms,':','LineWidth',3.5)
hold on
plot(xf,E3rms,'-.','LineWidth',3.5)
hold on
plot(xf,Enorma,'--','LineWidth',3.5)
legend('Original','Elevação', 'Descensão', 'Limite da norma')
set(gca, 'YScale', 'log')
ylim([0 9000])

set(h,'Units','Inches');
pos = get(h,'Position');
set(h,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[pos(3), pos(4)])
%print(h,'sup_caso1cond3_altura','-dpdf','-r0')

% xr1 = [-3 0 3];
% yr1 = [14.01 14.01 14.01];

% xr2 = [-10.478 -10.25 -0.228 0 10.022 10.25];
% yr2 = [14.290 14.290 14.290 14.290 14.290 14.290];

xr3 = [-10.478 -10.25 -10.021 -0.228 0 0.228 10.021 10.25 10.478];
yr3 = [16.530 16.758 16.530 16.530 16.758 16.530 16.530 16.758 16.530];

% xr4 = [-7.975 -7.025 -7.025 -7.975 -0.475 0.475 0.475 -0.475 7.025 7.975 7.975 7.025];
% yr4 = [18.45 18.45 17.5 17.5 25.95 25.95 25 25 18.45 18.45 17.5 17.5];

g = figure();
plot(xr3,yr3,'o','color','b')
xlabel('Faixa de passagem (m)')
ylabel('Altura dos cabos (m)')
grid
hold on
plot(x1,y1,'*','color','r')
hold on
plot(x3,y3,'x','color','r')
legend('Original','Elevação', 'Descensão')
% xlim([-3.5 3.5])
ylim([14 19])

set(g,'Units','Inches');
pos = get(g,'Position');
set(g,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[pos(3), pos(4)])
%print(h,'sup_caso1cond3_altura','-dpdf','-r0')